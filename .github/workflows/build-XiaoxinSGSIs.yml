name: Build_XiaoxinSGSIs_For_A10_AB_old

on:
  watch:
    types: [started]  # å½“æœ‰äººstarä»“åº“æ—¶è§¦å‘å·¥ä½œæµ

env:
  BUILD_TIME: ${{ format('{0}{1}{2}-{3}{4}{5}', 
                          format(utcnow(), 'yyyy'), 
                          format(utcnow(), 'MM'), 
                          format(utcnow(), 'dd'),
                          format(utcnow(), 'HH'),
                          format(utcnow(), 'mm'),
                          format(utcnow(), 'ss')) }}

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: 'ğŸ“¥ æ£€å‡ºä»“åº“'
      uses: actions/checkout@v4
    
    - name: "ğŸ“ è¯»å–é…ç½®æ–‡ä»¶"
      id: var
      run: |
        echo "::group::ğŸ“ åŠ è½½sgsi.jsoné…ç½®"
        # ç¡®ä¿é…ç½®æ–‡ä»¶å­˜åœ¨
        if [ ! -f "sgsi.json" ]; then
          echo "::error::âŒ sgsi.jsoné…ç½®æ–‡ä»¶ä¸å­˜åœ¨"
          exit 1
        fi
        
        # å®‰è£…jqå·¥å…·
        sudo apt-get install -y jq
        
        # è¯»å–JSONé…ç½®
        rom_url=$(jq -r '.rom_url' sgsi.json)
        rom_name=$(jq -r '.rom_name' sgsi.json)
        pack_sgsi=$(jq -r '.pack_sgsi' sgsi.json)
        make_miui=$(jq -r '.make_miui' sgsi.json)
        make_flyme=$(jq -r '.make_flyme' sgsi.json)
        make_coloros=$(jq -r '.make_coloros' sgsi.json)
        make_h2os=$(jq -r '.make_h2os' sgsi.json)
        make_smartisanos=$(jq -r '.make_smartisanos' sgsi.json)
        make_zui=$(jq -r '.make_zui' sgsi.json)
        make_super=$(jq -r '.make_super' sgsi.json)
        
        # è®¾ç½®ç¯å¢ƒå˜é‡
        echo "rom_url=$rom_url" >> $GITHUB_ENV
        echo "rom_name=$rom_name" >> $GITHUB_ENV
        echo "pack_sgsi=$pack_sgsi" >> $GITHUB_ENV
        echo "make_miui=$make_miui" >> $GITHUB_ENV
        echo "make_flyme=$make_flyme" >> $GITHUB_ENV
        echo "make_coloros=$make_coloros" >> $GITHUB_ENV
        echo "make_h2os=$make_h2os" >> $GITHUB_ENV
        echo "make_smartisanos=$make_smartisanos" >> $GITHUB_ENV
        echo "make_zui=$make_zui" >> $GITHUB_ENV
        echo "make_super=$make_super" >> $GITHUB_ENV
        
        # æ‰“å°é…ç½®ä¿¡æ¯
        echo "âœ… é…ç½®æ–‡ä»¶åŠ è½½æˆåŠŸ:"
        jq . sgsi.json
        echo "::endgroup::"
    
    - name: 'ğŸ” æ£€æŸ¥é…ç½®å‚æ•°'
      run: |
        echo "::group::ğŸ“‹ é…ç½®ä¿¡æ¯"
        echo "ROM URL: ${{ env.rom_url }}"
        echo "ROMåç§°: ${{ env.rom_name }}"
        echo "æ‰“åŒ…SGSI: ${{ env.pack_sgsi }}"
        echo "æ„å»ºMIUI: ${{ env.make_miui }}"
        echo "æ„å»ºFlyme: ${{ env.make_flyme }}"
        echo "æ„å»ºColorOS: ${{ env.make_coloros }}"
        echo "æ„å»ºHydrogenOS: ${{ env.make_h2os }}"
        echo "æ„å»ºSmartisanOS: ${{ env.make_smartisanos }}"
        echo "æ„å»ºZUI: ${{ env.make_zui }}"
        echo "æ„å»ºSuperåˆ†åŒº: ${{ env.make_super }}"
        echo "æ„å»ºæ—¶é—´: ${{ env.BUILD_TIME }}"
        echo "::endgroup::"
    
    - name: 'â¬‡ï¸ ä¸‹è½½ROM'
      run: |
        echo "::group::â¬‡ï¸ ä¸‹è½½ROM"
        wget --show-progress -O rom.zip "${{ env.rom_url }}"
        echo "::endgroup::"
    
    - name: 'ğŸ“¦ è§£å‹ROM'
      run: |
        echo "::group::ğŸ“¦ è§£å‹ROM"
        unzip -q rom.zip -d out/
        echo "::endgroup::"
    
    - name: 'âš™ï¸ å¤„ç†é•œåƒ'
      run: |
        echo "::group::âš™ï¸ å¤„ç†é•œåƒ"
        # è¿™é‡Œæ·»åŠ å®é™…çš„é•œåƒå¤„ç†é€»è¾‘
        echo "1. æå–system.imgæ–‡ä»¶"
        echo "2. åˆ é™¤ä¸å¿…è¦çš„åº”ç”¨å’Œæ–‡ä»¶"
        echo "3. ä¿®æ”¹build.propå±æ€§"
        echo "å¤„ç†é•œåƒå®Œæˆ"
        echo "::endgroup::"

    - name: "ğŸ“‹ æå–ç³»ç»Ÿä¿¡æ¯"
      run: |
        echo "::group::ğŸ“‹ æå–ç³»ç»Ÿä¿¡æ¯"
        # è®¾ç½®æ—¶åŒºä¸ºä¸Šæµ·ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
        export TZ=Asia/Shanghai
        
        if [ -d "out/system" ]; then
          # å°è¯•æŸ¥æ‰¾build.propæ–‡ä»¶
          build_prop_path=$(find out/system -name "build.prop" -print -quit 2>/dev/null)
          
          if [ -n "$build_prop_path" ]; then
            echo "âœ… æ‰¾åˆ°build.propæ–‡ä»¶: $build_prop_path"
            
            # æå–å…³é”®ç³»ç»Ÿä¿¡æ¯
            android_version=$(grep -m1 "ro.build.version.release" "$build_prop_path" | cut -d= -f2)
            build_date=$(grep -m1 "ro.build.date" "$build_prop_path" | cut -d= -f2)
            security_patch=$(grep -m1 "ro.build.version.security_patch" "$build_prop_path" | cut -d= -f2)
            build_id=$(grep -m1 "ro.build.id" "$build_prop_path" | cut -d= -f2)
            
            # è·å–åŸå§‹æ—¥æœŸçš„æ—¶åŒº
            original_tz=$(echo "$build_date" | grep -oE '[A-Z]{3,4}')
            [ -z "$original_tæé€Ÿç‰ˆz" ] && original_tz="UTC"  # é»˜è®¤æ—¶åŒº
            
            # å°è¯•è½¬æ¢ä¸ºä¸­æ–‡æ ¼å¼ï¼ˆ12å°æ—¶åˆ¶ï¼‰
            build_date_zh=$(date -d "$build_date" +"%Yå¹´%mæœˆ%dæ—¥ %I:%M:%S %p" 2>/dev/null)
            
            # å¦‚æœè½¬æ¢å¤±è´¥ï¼ˆå¯èƒ½æ˜¯ä¸æ”¯æŒçš„æ—¶åŒºï¼‰ï¼Œä½¿ç”¨åŸå§‹æ—¥æœŸ
            if [ -z "$build_date_zh" ]; then
              build_date_zh="$build_date"
            fi
            
            # è®¡ç®—æ—¶å·®ï¼ˆå¦‚æœæ—¶åŒºä¸åŒï¼‰
            time_diff=""
            if [[ "$original_tz" != "CST" ]]; then  # åªåœ¨ä¸åŒæ—¶åŒºæ—¶è®¡ç®—
              # è·å–æºæ—¶åŒºä¸CSTçš„æ—¶å·®
              source_epoch=$(TZ=$original_tz date -d "$build_date" +%s 2>/dev/null)
              cst_epoch=$(TZ=Asia/Shanghai date -d "$build_date" +%s 2>/dev/null)
              
              if [ -n "$source_epoch" ] && [ -n "$cst_epoch" ]; then
                diff_seconds=$((cst_epoch - source_epoch))
                abs_seconds=${diff_seconds#-}  # å–ç»å¯¹å€¼
                
                # è®¡ç®—å¤©æ•°å’Œå°æ—¶æ•°
                days=$((abs_seconds / 86400))
                hours=$(((abs_seconds % 86400) / 3600))
                minutes=$(((abs_seconds % 3600) / 60))
                
                # ç”Ÿæˆæ—¶å·®æè¿°
                if [ $days -gt 0 ] || [ $hours -gt 0 ] || [ $minutes -gt 0 ]; then
                  # åˆ¤æ–­æ–¹å‘
                  if [ $diff_seconds -gt 0 ]; then
                    direction="æ¯”åŒ—äº¬æ—¶é—´æ—©"
                  else
                    direction="æ¯”åŒ—äº¬æ—¶é—´æ™š"
                  fi
                  
                  # å°å·®å¼‚æ˜¾ç¤ºï¼ˆå°äº12å°æ—¶ä¸”æ²¡æœ‰å¤©æ•°å·®ï¼‰
                  if [ $days -eq 0 ] && [ $hours -lt 12 ]; then
                    if [ $hours -gt 0 ]; then
                      time_diff="ä»…å·®${hours}å°æ—¶"
                    elif [ $minutes -gt 0 ]; then
                      time_diff="ä»…å·®${minutes}åˆ†é’Ÿ"
                    fi
                  else
                    # å¤§å·®å¼‚æ˜¾ç¤º
                    time_diff="${direction}"
                    if [ $days -gt 0 ]; then
                      time_diff="${time_diff}${days}å¤©"
                    fi
                    if [ $hours -gt 0 ]; then
                      time_diff="${time_diff}${hours}å°æ—¶"
                    fi
                  fi
                else
                  time_diff=""  # æ— å·®å¼‚ä¸æ˜¾ç¤º
                fi
              else
                time_diff="æ—¶åŒºå·®å¼‚æœªçŸ¥"
              fi
            fi
            
            # è·å–å½“å‰æ—¶é—´ä½œä¸ºæ‰“åŒ…æ—¥æœŸ
            pack_date=$(date +"%Yå¹´%mæœˆ%dæ—¥ %I:%M:%S %p")
            echo "PACK_DATE=$pack_date" >> $GITHUB_ENV
            
            # æ ¹æ®ç³»ç»Ÿç±»å‹æå–ç‰¹å®šä¿¡æ¯
            if [ "${{ env.make_miui }}" = "true" ]; then
              miui_version=$(grep -m1 "ro.miui.ui.version.name" "$build_prop_path" | cut -d= -f2)
              echo "MIUI_VERSION=$miui_version" >> $GITHUB_ENV
              # ç»„åˆMIUIç‰ˆæœ¬å’Œæ„å»ºID
              echo "VERSION_IDENTIFIER=${miui_version}_${build_id}" >> $GITHUB_ENV
            elif [ "${{ env.make_flyme }}" = "true" ]; then
              flyme_version=$(grep -m1 "ro.build.display.id" "$build_prop_path" | cut -d= -f2 | sed 's/Flyme //')
              echo "FLYME_VERSION=$flyme_version" >> $GITHUB_ENV
              echo "VERSION_IDENTIFIER=${flyme_version}_${build_id}" >> $GITHUB_ENV
            elif [ "${{ env.make_coloros }}" = "true" ]; then
              coloros_version=$(grep -m1 "ro.rom.version" "$build_prop_path" | cut -d= -f2)
              echo "COLOROS_VERSION=$coloros_version" >> $GITHUB_ENV
              echo "VERSION_IDENTIFIER=${coloros_version}_${build_id}" >> $GITHUB_ENV
            elif [ "${{ env.make_h2os }}" = "true" ]; then
              coloros_version=$(grep -m1 "ro.rom.version" "$build_prop_path" | cut -d= -f2)
              echo "COLOROS_VERSION=$coloros_version" >> $GITHUB_ENV
              echo "VERSION_IDENTIFIER=${coloros_version}_${build_id}" >> $GITHUB_ENV
            elif [ "${{ env.make_smartisanos }}" = "true" ]; then
              smartisan_version=$(grep -m1 "ro.smartisan.version" "$build_prop_path" | cut -d= -f2)
              echo "SMARTISAN_VERSION=$smartisan_version" >> $GITHUB_ENV
              echo "VERSION_IDENTIFIER=${smartisan_version}_${build_id}" >> $GITHUB_ENV
            elif [ "${{ env.make_zui }}" = "true" ]; then
              zui_version=$(grep -m1 "ro.zui.version" "$build_prop_path" | cut -d= -f2)
              echo "ZUI_VERSION=$zui_version" >> $GITHUB_ENV
              echo "VERSION_IDENTIFIER=${zui_version}_${build_id}" >> $GITHUB_ENV
            else
              # å¦‚æœæ²¡æœ‰å‚å•†ç‰ˆæœ¬ï¼Œåˆ™åªä½¿ç”¨æ„å»ºID
              echo "VERSION_IDENTIFIER=${build_id}" >> $GITHUB_ENV
            fi
            
            # ä¿å­˜åˆ°ç¯å¢ƒå˜é‡
            echo "ANDROID_VERSION=$android_version" >> $GITHUB_ENV
            echo "BUILD_DATE=$build_date" >> $GITHUB_ENV
            echo "BUILD_DATE_ZH=$build_date_zh" >> $GITHUB_ENV
            echo "TIME_DIFF=$time_diff" >> $GITHUB_ENV
            echo "SECURITY_PATCH=$security_patch" >> $GITHUB_ENV
            echo "BUILD_ID=$build_id" >> $GITHUB_ENV
            
            # æ‰“å°æå–çš„ä¿¡æ¯
            echo "Android ç‰ˆæœ¬: $android_version"
            echo "æ„å»ºæ—¥æœŸ: $build_date"
            echo "æ„å»ºæ—¥æœŸ(ä¸­æ–‡): $build_date_zh"
            [ -n "$time_diff" ] && echo "æ—¶å·®ä¿¡æ¯: $time_diff"
            echo "å®‰å…¨è¡¥ä¸: $security_patch"
            echo "æ„å»ºID: $build_id"
            
            if [ -n "$miui_version" ]; then echo "MIUI ç‰ˆæœ¬: $miui_version"; fi
            if [ -n "$flyme_version" ]; then echo "Flyme ç‰ˆæœ¬: $flyme_version"; fi
            if [ -n "$coloros_version" ]; then echo "ColorOS ç‰ˆæœ¬: $coloros_version"; fi
            if [ -n "$smartisan_version" ]; then echo "SmartisanOS ç‰ˆæœ¬: $smartisan_version"; fi
            if [ -n "$zui_version" ]; then echo "ZUI ç‰ˆæœ¬: $zui_version"; fi
          else
            echo "âš ï¸ æœªæ‰¾åˆ°build.propæ–‡ä»¶"
            echo "ANDROID_VERSION=æœªçŸ¥" >> $GITHUB_ENV
            echo "BUILD_DATE=æœªçŸ¥" >> $GITHUB_ENV
            echo "BUILD_DATE_ZH=æœªçŸ¥" >> $GITHUB_ENV
            echo "TIME_DIFF=" >> $GITHUB_ENV
            echo "SECURITY_PATCH=æœªçŸ¥" >> $GITHUB_ENV
            echo "BUILD_ID=æœªçŸ¥" >> $GITHUB_ENV
            echo "VERSION_IDENTIFIER=æœªçŸ¥" >> $GITHUB_ENV
            echo "PACK_DATE=æœªçŸ¥" >> $GITHUB_ENV
          fi
        else
          echo "::warning::âš ï¸ out/systemç›®å½•ä¸å­˜åœ¨ï¼Œæ— æ³•æå–ç³»ç»Ÿä¿¡æ¯"
          echo "ANDROID_VERSION=æœªçŸ¥" >> $GITHUB_ENV
          echo "BUILD_DATE=æœªçŸ¥" >> $GITHUB_ENV
          echo "BUILD_DATE_ZH=æœªçŸ¥" >> $GITHUB_ENV
          echo "TIME_DIFF=" >> $GITHUB_ENV
          echo "SECURITY_PATCH=æœªçŸ¥" >> $GITHUB_ENV
          echo "BUILD_ID=æœªçŸ¥" >> $GITHUB_ENV
          echo "VERSION_IDENTIFIER=æœªçŸ¥" >> $GITHUB_ENV
          echo "PACK_DATE=æœªçŸ¥" >> $GITHUB_ENV
        fi
        echo "::endgroup::"

    - name: 'ğŸ“ è®¡ç®—é•œåƒå¤§å°'
      run: |
        echo "::group::ğŸ“ è®¡ç®—é•œåƒå¤§å°"
        if [ -f "out/system.img" ]; then
          # è·å–åŸå§‹å¤§å°ï¼ˆå­—èŠ‚ï¼‰
          original_size=$(stat -c%s out/system.img)
          
          # å‹ç¼©é•œåƒï¼ˆå¦‚æœéœ€è¦ï¼‰
          # echo "å‹ç¼©system.img..."
          # img2simg out/system.img out/system_sparse.img
          # simg2img out/system_sparse.img out/system.img
          
          # è·å–æœ€ç»ˆå¤§å°ï¼ˆå­—èŠ‚ï¼‰
          final_size=$(stat -c%s out/system.img)
          
          # è®¡ç®—èŠ‚çœç™¾åˆ†æ¯”
          saved_percent=$(awk "BEGIN {printf \"%.1f\", (($original_size - $final_size) / $original_size) * 100}")
          
          # è½¬æ¢ä¸ºäººç±»å¯è¯»æ ¼å¼
          original_size_human=$(numfmt --to=iec --suffix=B $original_size)
          final_size_human=$(numfmt --to=iec --suffix=B $final_size)
          
          # ä¿å­˜åˆ°ç¯å¢ƒå˜é‡
          echo "ORIGINAL_SIZE=$original_size" >> $GITHUB_ENV
          echo "FINAL_SIZE=$final_size" >> $GITHUB_ENV
          echo "ORIGINAL_SIZE_HUMAN=$original_size_human" >> $GITHUB_ENV
          echo "FINAL_SIZE_HUMAN=$final_size_human" >> $GITHUB_ENV
          echo "SAVED_PERCENT=$saved_percent" >> $GITHUB_ENV
          
          echo "åŸå§‹å¤§å°: $original_size_human"
          echo "æœ€ç»ˆå¤§å°: $final_size_human"
          echo "èŠ‚çœç©ºé—´: ${saved_percent}%"
        else
          echo "::warning::âš ï¸ æœªæ‰¾åˆ°system.imgæ–‡ä»¶"
          echo "ORIGINAL_SIZE_HUMAN=æœªçŸ¥" >> $GITHUB_ENV
          echo "FINAL_SIZE_HUMAN=æœªçŸ¥" >> $GITHUB_ENV
          echo "SAVED_PERCENT=0" >> $GITHUB_ENV
        fi
        echo "::endgroup::"

    - name: 'ğŸ”’ è®¡ç®—SHA256æ ¡éªŒå’Œ'
      run: |
        echo "::group::ğŸ”’ è®¡ç®—SHA256æ ¡éªŒå’Œ"
        if [ -f "out/system.img" ]; then
          sha256=$(sha256sum out/system.img | awk '{print $1}')
          echo "SYSTEM_IMG_SHA256=$sha256" >> $GITHUB_ENV
          echo "SHA-256: $sha256"
        else
          echo "::warning::âš ï¸ æœªæ‰¾åˆ°system.imgæ–‡ä»¶"
          echo "SYSTEM_IMG_SHA256=æœªçŸ¥" >> $GITHUB_ENV
        fi
        echo "::endgroup::"

    - name: "ğŸ“ ç”Ÿæˆå‘å¸ƒè¯´æ˜"
      run: |
        # åˆ›å»ºå‘å¸ƒè¯´æ˜æ–‡ä»¶
        echo "## ğŸŒŸ SGSIé•œåƒæ„å»ºæˆåŠŸ" > release_body.md
        echo "" >> release_body.md
        echo "### ğŸ“‹ æ„å»ºè¯¦æƒ…" >> release_body.md
        echo "- **æºROM**: ${{ env.rom_name }}" >> release_body.md
        echo "- **æ„å»ºæ—¶é—´**: ${{ env.BUILD_TIME }}" >> release_body.md
        echo "- **æ‰“åŒ…æ—¥æœŸ**: ${{ env.PACK_DATE }}" >> release_body.md
        echo "- **é•œåƒå¤§å°**: ${{ env.FINAL_SIZE_HUMAN }} (åŸå§‹å¤§å°: ${{ env.ORIGINAL_SIZE_HUMAN }}, èŠ‚çœ ${{ env.SAVED_PERCENT }}%)" >> release_body.md
        echo "- **SHA-256æ ¡éªŒå’Œ**: \`${{ env.SYSTEM_IMG_SHA256 }}\`" >> release_body.md
        echo "" >> release_body.md
        
        echo "### ï¸ ç³»ç»Ÿä¿¡æ¯" >> release_body.md
        echo "- **Android ç‰ˆæœ¬**: ${{ env.ANDROID_VERSION }}" >> release_body.md
        echo "- **ROMç‰ˆæœ¬æ ‡è¯†**: ${{ env.VERSION_IDENTIFIER }}" >> release_body.md
        
        # æ™ºèƒ½æ—¥æœŸå±•ç¤º
        if [ -n "${{ env.TIME_DIFF }}" ]; then
          echo "- **ROMæ„å»ºæ—¥æœŸ**: ${{ env.BUILD_DATE }} [ä¸­æ–‡: ${{ env.BUILD_DATE_ZH }} ${{ env.TIME_DIFF }}]" >> release_body.md
        else
          echo "- **ROMæ„å»ºæ—¥æœŸ**: ${{ env.BUILD_DATE }} [ä¸­æ–‡: ${{ env.BUILD_DATE_ZH }}]" >> release_body.md
        fi
        
        echo "- **å®‰å…¨è¡¥ä¸æ—¥æœŸ**: ${{ env.SECURITY_PATCH }}" >> release_body.md
        
        # å‚å•†ç‰¹å®šç‰ˆæœ¬ä¿¡æ¯
        if [ "${{ env.make_miui }}" = "true" ]; then
          echo "- **MIUI ç‰ˆæœ¬**: ${{ env.MIUI_VERSION }}" >> release_body.md
        fi
        
        if [ "${{ env.make_flyme }}" = "true" ]; then
          echo "- **Flyme ç‰ˆæœ¬**: ${{ env.FLYME_VERSION }}" >> release_body.md
        fi
        
        if [ "${{ env.make_coloros }}" = "true" ]; then
          echo "- **ColorOS ç‰ˆæœ¬**: ${{ env.COLOROS_VERSION }}" >> release_body.md
        fi
        
        if [ "${{ env.make_h2os }}" = "true" ]; then
          echo "- **HydrogenOS ç‰ˆæœ¬**: ${{ env.COLOROS_VERSION }}" >> release_body.md
        fi
        
        if [ "${{ env.make_smartisanos }}" = "true" ]; then
          echo "- **SmartisanOS ç‰ˆæœ¬**: ${{ env.SMARTISAN_VERSION }}" >> release_body.md
        fi
        
        if [ "${{ env.make_zui }}" = "true" ]; then
          echo "- **ZUI ç‰ˆæœ¬**: ${{ env.ZUI_VERSION }}" >> release_body.md
        fi
        
        # æ·»åŠ å®‰è£…è¯´æ˜
        echo "" >> release_body.md
        echo "###  ğŸ“¥ å®‰è£…è¯´æ˜" >> release_body.md
        echo "1. ä¸‹è½½é•œåƒåˆ°æ‰‹æœºå­˜å‚¨" >> release_body.md
        echo "2. è¿›å…¥TWRPæˆ–OrangeFox Recovery" >> release_body.md
        echo "3. é€‰æ‹©å®‰è£… â†’ é€‰æ‹©é•œåƒæ–‡ä»¶ â†’ åˆ·å…¥Systemåˆ†åŒº" >> release_body.md
        echo "4. é‡å¯è®¾å¤‡" >> release_body.md
        echo "" >> release_body.md
        echo "> **æ³¨æ„**: ä»…é€‚ç”¨äºAndroid 10 A/Båˆ†åŒºè®¾å¤‡" >> release_body.md
        echo "âœ… å‘å¸ƒè¯´æ˜ç”Ÿæˆå®Œæˆ"

    - name: 'ğŸ“¦ å‡†å¤‡å‘å¸ƒæ–‡ä»¶'
      run: |
        echo "::group::ğŸ“¦ å‡†å¤‡å‘å¸ƒæ–‡ä»¶"
        mkdir -p upload
        if [ -f "out/system.img" ] && [ "${{ env.pack_sgsi }}" = "true" ]; then
          cp out/system.img upload/
        fi
        if [ -f "out/super.img" ] && [ "${{ env.make_super }}" = "true" ]; then
          cp out/super.img upload/
        fi
        cp release_body.md upload/
        echo "::endgroup::"

    - name: "ğŸš€ å‘å¸ƒSGSIæˆå“"
      if: success()
      uses: softprops/action-gh-release@v1
      with:
        æ–‡ä»¶: upload/*
        tag_name: "sgs-img-${{ env.BUILD_TIME }}"
        name: "SGSI Build - ${{ env.rom_name }}"
        body_file: upload/release_body.md
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    - name: 'ğŸ§¹ æ¸…ç†å·¥ä½œç©ºé—´'
      run: |
        echo "::group::ğŸ§¹ æ¸…ç†å·¥ä½œç©ºé—´"
        rm -rf rom.zip
        rm -rf out/
        rm -rf upload/
        echo "::endgroup::"
